{
  "always_run_in_app" : false,
  "icon" : {
    "color" : "deep-green",
    "glyph" : "bookmark"
  },
  "name" : "Yusof Bandar's Bookmarks",
  "script" : "\nfunction generateBookmarksDom(bookmarks){\n\n  let contentDOM = '';\n  \n  bookmarks.forEach((bookmark) => {\n    let bookmarkDOM =\n        `\n        <div class=\"bookmark\">\n            <div class=\"bookmarkTitle\">\n                <a class=\"bookmarkTitleLink\" target=\"_blank\" href=\"${bookmark.link}\">${bookmark.title}<\/a>\n            <\/div>\n            <a class=\"bookmarkURI\" target=\"_blank\" href=\"${bookmark.link}\"  title=\"${bookmark.link}\">${bookmark.link.length > 123 ? bookmark.link.slice(0,123) + '...' : bookmark.link}<\/a>\n        <\/div>\n        `\n\n        contentDOM += bookmarkDOM;\n  })\n  \n  return contentDOM;\n}\n\nasync function writeChanges(indexPage64){\n  const baseURL = \"working-copy:\/\/x-callback-url\/write\"\n  let url = new CallbackURL(baseURL)\n\n  url.addParameter(\"key\", \"JB4WSD79TV\");\n  url.addParameter(\"repo\", \"Bandar_PinBoard\");\n  url.addParameter(\"path\", \"static\/index.html\");\n  url.addParameter(\"base64\", indexPage64);\n  url.addParameter(\"clipboard\",\"no\");\n  \n  let result = await url.open();\n  return result\n\n}\n\nasync function commitChanges(message){\n  const baseURL = \"working-copy:\/\/x-callback-url\/commit\"\n  let url = new CallbackURL(baseURL)\n\n  url.addParameter(\"key\", \"JB4WSD79TV\");\n  url.addParameter(\"repo\", \"Bandar_PinBoard\");\n  url.addParameter(\"limit\", \"50\");\n  url.addParameter(\"message\", message);\n  \n  let result = await url.open();\n  return result\n}\n\nasync function pushChangesOrigin(){\n  const baseURL = \"working-copy:\/\/x-callback-url\/push\"\n  let url = new CallbackURL(baseURL)\n\n  url.addParameter(\"key\", \"JB4WSD79TV\");\n  url.addParameter(\"repo\", \"Bandar_PinBoard\");\n  \n  let result = await url.open();\n  return result\n}\n\nasync function changesToServer(indexPage64){\n  await writeChanges(indexPage64);\n  await commitChanges('new bookmark added');\n  await pushChangesOrigin();\n}\n\nasync function readingBookmarks(){\n  const baseURL = \"working-copy:\/\/x-callback-url\/read\"\n  let url = new CallbackURL(baseURL)\n\n  url.addParameter(\"key\", \"JB4WSD79TV\");\n  url.addParameter(\"repo\", \"Bandar_PinBoard\");\n  url.addParameter(\"type\", \"auto\");\n  url.addParameter(\"path\", \"bookmarks.md\");\n  url.addParameter(\"clipboard\",\"no\");\n  \n  let result = await url.open();\n  result = result.text;\n  result = result.split('---'); \n  \n  let bookmarks = [];\n  \n  const titleReg = \/#{3} .{1,}\/;  \n  result.forEach((log) => {\n    let title = log.match(titleReg)[0] || 'no title';\n  \n    title = title.trim().replace(\/#\/g,'');\n    const fav = title[title.length-1] === '*';\n    title = title.trim().replace(\/\\*\/g,'');\n  \n    let url = log.match(\/\\(.*?\\)\/)[0] || 'no url found';\n    url = url.replace(\/\\(|\\)\/g,'');\n  \n    bookmarks.push({\n      title: title,\n      link: url,\n      fav: fav\n    })\n  \n  })\n  \n  return bookmarks;\n}\n\nlet bookmarks = await readingBookmarks();\nlet bookmarksDOM = generateBookmarksDom(bookmarks);\n\nlet finalPageDOM = generateFinalPage(bookmarksDOM);\nawait changesToServer(btoa(finalPageDOM));\n\nScript.complete()\n\n\n\n\n\n\n\n\n\n\n\n\nfunction generateFinalPage(content){\n\n    let dom = `\n    <head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n\n    <meta name=\"description\" content=\"A collection of public Yusof Bandar's bookmarks\">\n    <meta name=\"keywords\" content=\"Yusof,Bandar,Bookmarks,Public,YusofBandar\">\n    <meta name=\"author\" content=\"Yusof Bandar\">\n    <meta name=\"google-site-verification\" content=\"cQv6BQltkNiw5IImCn5aUZzECJV-NW9L-VEyl81-q8E\" \/>\n\n    <title>Yusof Bandar's Bookmarks<\/title>\n    \n    <link rel=\"apple-touch-icon\" sizes=\"180x180\" href=\".\/images\/favicon\/apple-touch-icon.png\">\n    <link rel=\"icon\" type=\"image\/png\" sizes=\"32x32\" href=\".\/images\/favicon\/favicon-32x32.png\">\n    <link rel=\"icon\" type=\"image\/png\" sizes=\"16x16\" href=\".\/images\/favicon\/favicon-16x16.png\">\n    <link rel=\"manifest\" href=\".\/images\/favicon\/site.webmanifest\">\n    <link rel=\"mask-icon\" href=\".\/images\/favicon\/safari-pinned-tab.svg\" color=\"#8b7e7e\">\n    <meta name=\"msapplication-TileColor\" content=\"#2b5797\">\n    <meta name=\"theme-color\" content=\"#ffffff\">\n    \n    <link rel=\"stylesheet\" type=\"text\/css\" href=\".\/styling.css\">\n\n    <body>\n    <div class=\"top-bar\">\n        <div class=\"title\">\n            <a href=\".\/index.html\"> <img class=\"logo\" src=\"images\/logo.png\" alt=\"Green Book Logo\"><\/a>\n            <h1 class=\"header\">Yusof Bandar's Bookmarks<\/h1>\n            <button class=\"clear-button github-logo\" aria-label=\"Github logo linking to the github repo\" alt=\"Github logo\">\n                <a href=\"https:\/\/github.com\/YusofBandar\/Bandar_PinBoard\" target=\"_blank\">\n                    <svg height=\"32\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"32\" aria-hidden=\"true\">\n                        <path fill-rule=\"evenodd\" d=\"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z\"><\/path>\n                    <\/svg>\n                <\/a>\n            <\/button>\n            <button class=\"clear-button edit-logo\" aria-label=\"Pencil icon linking to the bookmarks markdown file\" alt=\"Pencil\">\n                <a href=\"https:\/\/github.com\/YusofBandar\/Bandar_PinBoard\/edit\/master\/bookmarks.md\" target=\"_blank\">\n                    <svg height=\"32\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"32\" aria-hidden=\"true\">\n                        <path fill-rule=\"evenodd\" d=\"M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z\"><\/path>\n                    <\/svg>\n                <\/a>\n            <\/button>\n        <\/div>\n        <span class=\"navigation\"><a href=\".\/index.html\">Index<\/a> <a href=\".\/favourite.html\">Favourite<\/a> <a href=\".\/readingList.html\">Reading<\/a><\/span>\n    <\/div>\n        <div class=\"content inline\">\n            ${content}\n        <\/div>\n\n    <\/body>\n    <\/head>`\n\n    return dom\n}\n",
  "share_sheet_inputs" : [

  ]
}